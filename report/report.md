./profiler.sh -d 90 -e lock -f hw3lock_put.html 712  
./profiler.sh -d 90 -e alloc -f hw3alloc_put.html 712  
./profiler.sh -d 90 -f hw3cpu_put.html 712

wrk -c 64 -t 3 -d 1m -R 10000 -L -s get.lua http://localhost:8080

wrk -c 120 -t 3 -d 2m -R 20000 -L -s put.lua http://localhost:8080  
Running 2m test @ http://localhost:8080  
3 threads and 120 connections  
Thread calibration: mean lat.: 5.503ms, rate sampling interval: 25ms  
Thread calibration: mean lat.: 6.219ms, rate sampling interval: 25ms  
Thread calibration: mean lat.: 8.923ms, rate sampling interval: 28ms  
Thread Stats Avg Stdev Max +/- Stdev  
Latency 2.40ms 3.10ms 60.38ms 90.78%  
Req/Sec 6.81k 1.04k 17.52k 81.71%  
Latency Distribution (HdrHistogram - Recorded Latency)  
50.000% 1.49ms  
75.000% 2.32ms  
90.000% 5.15ms  
99.000% 15.56ms  
99.900% 31.49ms  
99.990% 47.90ms  
99.999% 57.06ms  
100.000% 60.42ms

Detailed Percentile spectrum:  
Value Percentile TotalCount 1/(1-Percentile)

       0.058     0.000000            1         1.00
       0.614     0.100000       219676         1.11
       0.849     0.200000       439699         1.25
       1.062     0.300000       659121         1.43
       1.274     0.400000       879248         1.67
       1.492     0.500000      1098797         2.00
       1.605     0.550000      1207802         2.22
       1.731     0.600000      1318318         2.50
       1.876     0.650000      1427629         2.86
       2.061     0.700000      1537187         3.33
       2.321     0.750000      1647592         4.00
       2.501     0.775000      1702278         4.44
       2.741     0.800000      1756991         5.00
       3.085     0.825000      1811956         5.71
       3.563     0.850000      1866756         6.67
       4.231     0.875000      1921488         8.00
       4.651     0.887500      1948923         8.89
       5.147     0.900000      1976365        10.00
       5.735     0.912500      2003880        11.43
       6.427     0.925000      2031371        13.33
       7.255     0.937500      2058724        16.00
       7.711     0.943750      2072480        17.78
       8.223     0.950000      2086246        20.00
       8.791     0.956250      2099931        22.86
       9.463     0.962500      2113634        26.67
      10.279     0.968750      2127377        32.00
      10.751     0.971875      2134208        35.56
      11.279     0.975000      2141098        40.00
      11.879     0.978125      2147917        45.71
      12.591     0.981250      2154803        53.33
      13.455     0.984375      2161660        64.00
      13.959     0.985938      2165111        71.11
      14.495     0.987500      2168519        80.00
      15.135     0.989062      2171972        91.43
      15.871     0.990625      2175373       106.67
      16.815     0.992188      2178830       128.00
      17.391     0.992969      2180556       142.22
      17.999     0.993750      2182229       160.00
      18.751     0.994531      2183952       182.86
      19.679     0.995313      2185664       213.33
      20.783     0.996094      2187394       256.00
      21.391     0.996484      2188236       284.44
      22.191     0.996875      2189101       320.00
      23.135     0.997266      2189957       365.71
      24.191     0.997656      2190812       426.67
      25.631     0.998047      2191667       512.00
      26.399     0.998242      2192098       568.89
      27.295     0.998437      2192526       640.00
      28.543     0.998633      2192951       731.43
      30.127     0.998828      2193384       853.33
      31.679     0.999023      2193813      1024.00
      32.431     0.999121      2194027      1137.78
      33.215     0.999219      2194244      1280.00
      34.463     0.999316      2194454      1462.86
      35.935     0.999414      2194675      1706.67
      37.311     0.999512      2194885      2048.00
      38.111     0.999561      2194996      2275.56
      38.975     0.999609      2195102      2560.00
      40.159     0.999658      2195204      2925.71
      41.407     0.999707      2195313      3413.33
      42.463     0.999756      2195418      4096.00
      43.007     0.999780      2195471      4551.11
      43.679     0.999805      2195526      5120.00
      44.671     0.999829      2195580      5851.43
      45.695     0.999854      2195633      6826.67
      46.847     0.999878      2195686      8192.00
      47.327     0.999890      2195713      9102.22
      47.999     0.999902      2195741     10240.00
      48.575     0.999915      2195768     11702.86
      49.247     0.999927      2195793     13653.33
      50.079     0.999939      2195819     16384.00
      50.751     0.999945      2195833     18204.44
      51.263     0.999951      2195846     20480.00
      52.383     0.999957      2195860     23405.71
      52.927     0.999963      2195873     27306.67
      53.375     0.999969      2195887     32768.00
      53.727     0.999973      2195894     36408.89
      54.111     0.999976      2195900     40960.00
      54.559     0.999979      2195908     46811.43
      55.007     0.999982      2195913     54613.33
      55.647     0.999985      2195920     65536.00
      55.999     0.999986      2195923     72817.78
      56.735     0.999988      2195927     81920.00
      57.023     0.999989      2195930     93622.86
      57.311     0.999991      2195934    109226.67
      57.567     0.999992      2195937    131072.00
      57.759     0.999993      2195938    145635.56
      57.983     0.999994      2195940    163840.00
      58.175     0.999995      2195942    187245.71
      58.239     0.999995      2195943    218453.33
      58.431     0.999996      2195945    262144.00
      58.463     0.999997      2195946    291271.11
      59.007     0.999997      2195947    327680.00
      59.039     0.999997      2195948    374491.43
      59.039     0.999998      2195948    436906.67
      59.263     0.999998      2195949    524288.00
      59.391     0.999998      2195950    582542.22
      59.391     0.999998      2195950    655360.00
      59.743     0.999999      2195951    748982.86
      59.743     0.999999      2195951    873813.33
      59.743     0.999999      2195951   1048576.00
      60.383     0.999999      2195952   1165084.44
      60.383     0.999999      2195952   1310720.00
      60.383     0.999999      2195952   1497965.71
      60.383     0.999999      2195952   1747626.67
      60.383     1.000000      2195952   2097152.00
      60.415     1.000000      2195953   2330168.89
      60.415     1.000000      2195953          inf

[Mean = 2.399, StdDeviation = 3.096]  
[Max = 60.384, Total count = 2195953]  
[Buckets = 27, SubBuckets = 2048]
----------------------------------------------------------  
2392009 requests in 2.00m, 152.84MB read  
Requests/sec:  19933.65  
Transfer/sec:      1.27MB

----


./profiler.sh -d 90 -e lock -f hw3lock_get.html 712  
./profiler.sh -d 90 -e alloc -f hw3alloc_get.html 712  
./profiler.sh -d 90 -f hw3cpu_get.html 712

# GET

По наполненной базе

root@DESKTOP-E01FUOQ:~/wrk2# wrk -c 120 -t 3 -d 2m -R 20000 -L -s get.lua http://localhost:8080  
Running 2m test @ http://localhost:8080  
3 threads and 120 connections  
Thread calibration: mean lat.: 99.163ms, rate sampling interval: 688ms  
Thread calibration: mean lat.: 98.822ms, rate sampling interval: 688ms  
Thread calibration: mean lat.: 106.299ms, rate sampling interval: 711ms  
Thread Stats Avg Stdev Max +/- Stdev  
Latency 5.10ms 7.53ms 51.04ms 86.15%  
Req/Sec 6.67k 92.75 7.02k 79.24%  
Latency Distribution (HdrHistogram - Recorded Latency)  
50.000% 1.78ms  
75.000% 4.50ms  
90.000% 16.67ms  
99.000% 33.63ms  
99.900% 42.59ms  
99.990% 47.07ms  
99.999% 50.21ms  
100.000% 51.07ms

Detailed Percentile spectrum:  
Value Percentile TotalCount 1/(1-Percentile)

       0.100     0.000000            1         1.00
       0.799     0.100000       219727         1.11
       1.065     0.200000       440111         1.25
       1.298     0.300000       659397         1.43
       1.531     0.400000       879343         1.67
       1.780     0.500000      1098782         2.00
       1.929     0.550000      1208531         2.22
       2.095     0.600000      1318921         2.50
       2.329     0.650000      1427838         2.86
       2.831     0.700000      1537611         3.33
       4.499     0.750000      1647311         4.00
       5.731     0.775000      1702262         4.44
       7.503     0.800000      1757083         5.00
       9.423     0.825000      1812054         5.71
      11.495     0.850000      1867028         6.67
      14.039     0.875000      1921820         8.00
      15.335     0.887500      1949392         8.89
      16.671     0.900000      1976935        10.00
      17.999     0.912500      2004270        11.43
      19.407     0.925000      2031667        13.33
      21.199     0.937500      2059127        16.00
      22.207     0.943750      2072947        17.78
      23.199     0.950000      2086742        20.00
      24.271     0.956250      2100358        22.86
      25.375     0.962500      2114032        26.67
      26.655     0.968750      2127839        32.00
      27.439     0.971875      2134653        35.56
      28.303     0.975000      2141492        40.00
      29.247     0.978125      2148395        45.71
      30.255     0.981250      2155214        53.33
      31.279     0.984375      2162090        64.00
      31.823     0.985938      2165461        71.11
      32.463     0.987500      2168886        80.00
      33.183     0.989062      2172417        91.43
      33.983     0.990625      2175781       106.67
      34.975     0.992188      2179290       128.00
      35.487     0.992969      2180910       142.22
      36.063     0.993750      2182674       160.00
      36.639     0.994531      2184407       182.86
      37.183     0.995313      2186048       213.33
      37.727     0.996094      2187823       256.00
      38.015     0.996484      2188707       284.44
      38.303     0.996875      2189512       320.00
      38.655     0.997266      2190366       365.71
      39.135     0.997656      2191222       426.67
      39.871     0.998047      2192058       512.00
      40.415     0.998242      2192493       568.89
      40.927     0.998437      2192916       640.00
      41.503     0.998633      2193349       731.43
      42.079     0.998828      2193780       853.33
      42.655     0.999023      2194195      1024.00
      43.007     0.999121      2194423      1137.78
      43.359     0.999219      2194636      1280.00
      43.711     0.999316      2194839      1462.86
      44.095     0.999414      2195070      1706.67
      44.415     0.999512      2195274      2048.00
      44.639     0.999561      2195390      2275.56
      44.831     0.999609      2195481      2560.00
      45.055     0.999658      2195588      2925.71
      45.311     0.999707      2195701      3413.33
      45.631     0.999756      2195803      4096.00
      45.887     0.999780      2195861      4551.11
      46.079     0.999805      2195914      5120.00
      46.303     0.999829      2195967      5851.43
      46.463     0.999854      2196017      6826.67
      46.719     0.999878      2196070      8192.00
      46.911     0.999890      2196098      9102.22
      47.071     0.999902      2196126     10240.00
      47.263     0.999915      2196153     11702.86
      47.455     0.999927      2196177     13653.33
      47.711     0.999939      2196203     16384.00
      47.871     0.999945      2196221     18204.44
      47.967     0.999951      2196232     20480.00
      48.063     0.999957      2196244     23405.71
      48.159     0.999963      2196258     27306.67
      48.351     0.999969      2196272     32768.00
      48.447     0.999973      2196279     36408.89
      48.639     0.999976      2196284     40960.00
      49.055     0.999979      2196291     46811.43
      49.631     0.999982      2196297     54613.33
      49.887     0.999985      2196304     65536.00
      49.951     0.999986      2196308     72817.78
      50.143     0.999988      2196311     81920.00
      50.175     0.999989      2196314     93622.86
      50.239     0.999991      2196318    109226.67
      50.335     0.999992      2196321    131072.00
      50.463     0.999993      2196324    145635.56
      50.463     0.999994      2196324    163840.00
      50.527     0.999995      2196327    187245.71
      50.527     0.999995      2196327    218453.33
      50.687     0.999996      2196329    262144.00
      50.719     0.999997      2196330    291271.11
      50.751     0.999997      2196331    327680.00
      50.783     0.999997      2196332    374491.43
      50.783     0.999998      2196332    436906.67
      50.815     0.999998      2196333    524288.00
      50.847     0.999998      2196334    582542.22
      50.847     0.999998      2196334    655360.00
      50.943     0.999999      2196335    748982.86
      50.943     0.999999      2196335    873813.33
      50.943     0.999999      2196335   1048576.00
      51.007     0.999999      2196336   1165084.44
      51.007     0.999999      2196336   1310720.00
      51.007     0.999999      2196336   1497965.71
      51.007     0.999999      2196336   1747626.67
      51.007     1.000000      2196336   2097152.00
      51.071     1.000000      2196337   2330168.89
      51.071     1.000000      2196337          inf

[Mean = 5.104, StdDeviation = 7.526]  
[Max = 51.040, Total count = 2196337]  
[Buckets = 27, SubBuckets = 2048]
----------------------------------------------------------
2398078 requests in 2.00m, 168.89MB read  
Requests/sec:  19983.84  
Transfer/sec:      1.41MB

# ВЫВОДЫ:

[cpu_put](hw3cpu_put.html)
[alloc_put](hw3alloc_put.html)
[lock_put](hw3lock_put.html)

## Put:

[cpu_get](hw3cpu_get.html)
[alloc_get](hw3alloc_get.html)
[lock_get](hw3lock_get.html)

## Get:

